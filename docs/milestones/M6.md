# M6 交付说明（network）

## 范围

- 网络栈：ARP / IPv4 / ICMP / UDP / TCP（简化实现）
- socket API：bind/listen/accept/connect/sendto/recvfrom
- 用户态工具源码：ping / http server / http client

## 代码文件

- `include/nm/net.h`
- `include/nm/socket.h`
- `kernel/net/net.c`
- `kernel/net/arp.c`
- `kernel/net/ipv4.c`
- `kernel/net/icmp.c`
- `kernel/net/udp.c`
- `kernel/net/tcp.c`
- `kernel/net/socket.c`
- `tests/unit/test_net.c`
- `userspace/ping.c`
- `userspace/http_server.c`
- `userspace/http_client.c`

## 关键函数签名

- `void net_init(void);`
- `int udp_sendto(uint16_t src_port, uint32_t dst_ip, uint16_t dst_port, const void *payload, uint16_t len);`
- `int tcp_connect(uint32_t dst_ip, uint16_t dst_port, uint16_t src_port);`
- `int nm_socket(int domain, int type, int protocol);`
- `int nm_listen(int sockfd, int backlog);`
- `int nm_accept(int sockfd, struct nm_sockaddr_in *addr);`
- `int64_t nm_sendto(int sockfd, const void *buf, uint64_t len, const struct nm_sockaddr_in *addr);`
- `int64_t nm_recvfrom(int sockfd, void *buf, uint64_t len, struct nm_sockaddr_in *addr);`

## 验证命令

```bash
make clean all
make test
make smoke
```
